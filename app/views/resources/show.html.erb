<% content_for :title, "#{@resource.name.titleize} service < #{@resource.version.name} < REST API" -%>

<div class="row">
    <div class="span3 subnav">
        <ul class="nav nav-tabs nav-stacked affix">
            <% @resource.services.order("position ASC").each do |s| %>
            <li>
                <a href="#<%= "#{s.http_method.upcase}_#{s.summary.downcase.strip.gsub('/ ', '_').gsub(/[^\w-]/, '')}" %>">
                    <span class="badge badge-<%= http_method_color(s.http_method) %>">&nbsp;</span>
                    <%= s.summary %>
                </a>
            </li>
            <% end %>
        </ul>
    </div>

    <div class="span9">
        <div id="sections">
            <% @resource.services.order("position ASC").each do |s| %>
                <%= render :partial => "services/show", :locals => { :service => s } %>
            <% end %>
        </div> <!-- /#sections -->
    </div>
</div>


<% content_for :javascript do %>
    <script type="text/javascript">
        $(function() {
            function refresh_scrollspy() {
                setTimeout(function() {
                    $('[data-spy="scroll"]').each(function () {
                        var $spy = $(this).scrollspy('refresh');
                        console.log($spy);
                    });
                }, 10);
            }

            $('#sections').on('hidden', function () {
                refresh_scrollspy();
            }).on('shown', function() {
                refresh_scrollspy();
            });
        })
    </script>
<% end %>